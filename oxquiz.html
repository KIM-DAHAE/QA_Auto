<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="static/scss/common.css">
    <link rel="stylesheet" href="static/scss/quiz.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <title>OX 퀴즈</title>
</head>
<body>
    <header class="header">
        <h1>
            <a href="oxquiz_intro.html">
                <img src="static/images/quiz/logo.png" alt="ptkorea">
            </a>
        </h1>
        <p><strong>OX </strong>QUIZ</p>
    </header>
    <div class="container">
        <div class="contents">
            <div class="quiz__wrap">
                <div class="title">
                    <p><span class="text--orange">Y</span>OU</p>
                    <p>QA Tool</p>
                    <!-- <div class="system_done"></div> --> <!-- 241028 삭제 -->
                    <div class="timer__wrap">
                        <div class="wave_ani__wrap">
                            <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                            viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
                                <defs>
                                    <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
                                </defs>
                                <g class="wave__ani">
                                    <use xlink:href="#gentle-wave" x="48" y="0" fill="#feb95a" />
                                </g>
                            </svg>
                        </div>
                        <div class="timer"><span>45</span>:<span>00</span></div>
                        <div class="time_over__ani">
                            <img src="static/images/quiz/img_timeover.png" alt="timeover">
                        </div>
                    </div>
                    <div class="water_drop__ani">
                        <span class="water_drop1"></span>
                        <span class="water_drop2"></span>
                        <span class="water_drop3"></span>
                    </div>
                </div>
                <div class="quiz">
                    <p>Q. <span class="num"><em class="count">1</em>/10</span></p>
                    <p class="question">여기에 문제가 표시됩니다.</p>
                    <p class="tip__wrap">Tip <span class="tip">제품 여러개가 노출되면 복잡해 보이겠네요.</span></p>
                    <img src="static/images/quiz/img_question01.png" alt="q1" id="question-image">
                    <div class="btn__wrap">
                        <button type="button" class="btn btn__o">O</button>
                        <button type="button" class="btn btn__x">X</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- <div class="popup fail">
        <div class="popup__inner">
            <p class="result"><strong>아쉽습니다.</strong>시간이 너무 짧았죠. <br> 저희 QA Tool 만큼은 아니지만 <br>그래도 최선을 다해 퀴즈를 풀어주셔서<br>감사합니다.</p>
            <p class="msg">저희가 준비한 “참가상” 받아가세요!<br>ByeBye~</p>
            <a href="oxquiz_intro.html" class="btn__next">→ 다음 게임</a>
        </div>
    </div>

    <div class="popup success">
        <div class="popup__inner">
            <img src="static/images/quiz/img_success.png" alt="성공">
            <p class="result"><strong>기록! “<span class="record">21</span>초”</strong>저희 QA Tool은 0.03초만에 풀었는데…</p>
            <p class="score__wrap"><span class="score">90</span>점</p>
            <p class="msg">축하드립니다.<br>역시 콘텐츠를 보실 줄 아시는<br> <span class="text--blue">QA Master</span>를 만나게 되어 기쁩니다.</p>
            <a href="oxquiz_intro.html" class="btn__next">→ 간식받아 가세요</a>
        </div>
    </div>

    <div class="popup lose">
        <div class="popup__inner">
            <img src="static/images/quiz/img_lose.png" alt="실패">
            <p class="result"><strong>기록! “<span class="record">21</span>초”</strong>저희 QA Tool은 0.03초만에 풀었는데…</p>
            <p class="score__wrap"><span class="score">50</span>점</p>
            <p class="msg">안타깝습니다.<br>제한시간에 문제풀이를 마치셨지만, 아<br>쉽게도 기준 점수에는 부족하네요.</p>
            <a href="oxquiz_intro.html" class="btn__next">→ 간식받아 가세요</a>
        </div>
    </div> -->

    <div class="popup">
        <div class="popup__inner">
            <div class="popup__title__wrap">
                <p class="popup__title">아쉽습니다</p>
                <p class="score__wrap"><span class="score">50</span>점</p>
            </div>
            <img src="static/images/quiz/img_lose.png" alt="실패" class="img__fail">
            <img src="static/images/quiz/img_success1.png" alt="성공" class="img__success1">
            <img src="static/images/quiz/img_success2.png" alt="성공" class="img__success2">
            <img src="static/images/quiz/img_success3.png" alt="성공" class="img__success3">
            <div class="record__box">
                <ul>
                    <li class="player">
                        <strong class="record__title">플레이어 기록</strong>
                        <p class="fail">Time over</p>
                        <div class="graph__wrap">
                            <div class="graph">
                                <div class="bar"></div>
                                <p class="result"><span class="record">48</span></p>
                            </div>
                        </div>
                    </li>
                    <li class="average">
                        <strong class="record__title">평균 기록</strong>
                        <div class="graph__wrap">
                            <div class="graph">
                                <div class="bar"></div>
                                <p class="result">48초</p>
                            </div>
                        </div>
                    </li>
                    <li class="qa">
                        <strong class="record__title">QA Tool 기록</strong>
                        <div class="graph__wrap">
                            <div class="graph">
                                <div class="bar"></div>
                                <p class="result">0.03초</p>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
            <p class="msg fail">시간이 너무 짧았죠.<br>최선을 다해 퀴즈를 풀어주셔서 감사합니다.</p>
            <p class="msg success1">"와우, 이건 거의 <strong class="text--blue">‘QA 마스터’</strong> 급 실력인데요?<br> 속도와 정확도 모두 완벽합니다!"</p>
            <p class="msg success2">"오~ 이건 거의 <strong class="text--blue">‘QA 스페셜리스트’</strong><br> 수준이네요! 한 수 배우고 갑니다!"</p>
            <p class="msg success3">"오~ 아슬아슬했지만 성공하셨습니다!<br> 끝까지 포기 없는 <strong class="text--blue">‘QA 챌린저’</strong>다운 모습이네요!"</p>
            <p class="msg lose">안타깝습니다.<br>제한시간에 문제풀이를 마치셨지만,<br>아쉽게도 기준 점수에는 부족하네요.</p>
            <a href="oxquiz_intro.html" class="btn__next">→ 참여해주셔서 감사합니다.</a>
            <img src="static/images/quiz/img_grade.png" alt="등급표" class="img__grade">
        </div>
    </div>
     
<script>
    $(document).ready(function(){
        /* s: 241028 스크립트 삭제 */
        // setTimeout(function(){
            //     $('.system_done').addClass('active');
            // }, 1000)
        /* e: 241028 스크립트 삭제 */
            
            // 퀴즈 데이터 배열 (문제, 이미지, 정답)
        var quizData = [
        { 
            question: "올바른 제품 정보를 전달하기 위해 깨끗한 제품 이미지를 노출한다.", 
            image: "static/images/quiz/img_question01.png", 
            answer: "O", 
            tip: "정확한 제품에 대한 이미지를 사용해야 합니다."
        },
        { 
            question: "좁은 공간에 최대한 많은 제품을 표현하기 위해 모든 제품을 겹쳐서 노출할 수 있다.", 
            image: "static/images/quiz/img_question02.png", 
            answer: "X", 
            tip: "겹쳐진 제품은 어떤 제품인지 명확히 인지하기 어려울 수 있습니다."
        },
        { 
            question: "제품 이미지는 최대한 많은 제품을 노출해야 한다.", 
            image: "static/images/quiz/img_question03.png", 
            answer: "X", 
            tip: "좁은 영역에 너무 많은 제품을 노출하면 제품 정보 표현에 방해가 될 수 있습니다."
        },
        { 
            question: "PTK의 로고는 아래와 같이 사용된다.", 
            image: "static/images/quiz/img_question04.png", 
            answer: "O", 
            tip: "PTK의 정석 로고는 위와 같이 사용됩니다."
        },
        { 
            question: "PTK의 로고는 아래와 같이 사용된다.", 
            image: "static/images/quiz/img_question05.png", 
            answer: "X", 
            tip: "PTK 로고는 단일 컬러로 이루어져 있습니다."
        },
        { 
            question: "PTK의 로고는 아래와 같이 사용된다.", 
            image: "static/images/quiz/img_question06.png", 
            answer: "X", 
            tip: "이보다는 디자인이 들어간 형태일 것입니다."
        },
        { 
            question: "2개 이상의 제품을 구성할 때는 제품이 겹치지 않도록 구성해야 한다.", 
            image: "static/images/quiz/img_question07.png", 
            answer: "O", 
            tip: "주요 제품에 대한 정보가 명확히 인식될 수 있습니다."
        },
        { 
            question: "타이틀 영역에는 요즘 MZ 세대의 의견을 반영한 표현으로 카피 설정이 가능하다.", 
            image: "static/images/quiz/img_question08.png", 
            answer: "X", 
            tip: "모두가 이해할 수 있는 언어로 카피가 구성되어야 합니다."
        },
        { 
            question: "제품의 배경 색상은 제품과 어울리는 컬러로 적용할 수 있다.", 
            image: "static/images/quiz/img_question09.png", 
            answer: "O", 
            tip: "제품을 잘 표현할 수 있는 단일 컬러로 가이드하고 있습니다."
        },
        { 
            question: "제품 이미지에 맞추어 상하 그라데이션도 가능하다.", 
            image: "static/images/quiz/img_question10.png", 
            answer: "X", 
            tip: "콘텐츠 제작 가이드에서는 원형 그라데이션으로 배경을 구성하고 있습니다."
        },
        { 
            question: "이미지 하단에 카피가 포함되어 있다면 별도의 카피를 적용하지 않아도 된다.", 
            image: "static/images/quiz/img_question11.png", 
            answer: "X", 
            tip: "이미지 내 카피보다는 별도의 카피 영역을 사용하는 것이 좋습니다."
        },
        { 
            question: "제품을 효과적으로 표현하기 위해 반짝이는 요소를 배치해도 된다.", 
            image: "static/images/quiz/img_question12.png", 
            answer: "X", 
            tip: "제품 이미지와 배경에 장식을 추가하면 페이지 전체가 혼란스러울 수 있습니다."
        },
        { 
            question: "썸네일 영역을 최대한 활용하여 이미지를 디자인한다.", 
            image: "static/images/quiz/img_question13.png", 
            answer: "X", 
            tip: "어떤 제품인지 명확하게 인지하기 어려운 이미지는 정보 탐색에 방해가 될 수 있습니다."
        },
        { 
            question: "전체 페이지의 심플한 구성을 위해 정해진 영역 안에서 이미지를 노출한다.", 
            image: "static/images/quiz/img_question14.png", 
            answer: "O", 
            tip: "규격화된 가이드를 통해 깔끔하고 체계적으로 정리된 페이지로 구현할 수 있습니다."
        },
        { 
            question: "디자인에 따라 제품의 일부만 노출될 수 있다.", 
            image: "static/images/quiz/img_question15.png", 
            answer: "X", 
            tip: "제품의 전체 정보를 제공하지 않으면 사용자가 잘못된 정보를 경험할 수 있습니다."
        }
        ];

        var selectedQuestions = [];
        var totalQuestions = 10;
        var correctAnswers = 0;
        var score = 0;  
        var currentQuestionIndex = 0;
        var timerDuration = 90; 
        var timer;
        var startTime;
        var elapsedTime = 0;

        function selectRandomQuestions() {
            var quizPool = quizData.slice();
            while (selectedQuestions.length < totalQuestions) {
                var randomIndex = Math.floor(Math.random() * quizPool.length);
                selectedQuestions.push(quizPool.splice(randomIndex, 1)[0]);
            }
        }

        function showQuestion(index) {
            if (index < selectedQuestions.length) {
                var question = selectedQuestions[index];
                $(".question").text(question.question);
                $("#question-image").attr("src", question.image);
                $(".count").text(index + 1);

                // Tip 설정
                if (question.tip) {
                    $(".tip__wrap").show(); // Tip 랩을 보이도록 설정
                    $(".tip").text(question.tip); // Tip 텍스트 설정
                } else {
                    $(".tip__wrap").hide(); // Tip이 없을 경우 숨김 처리
                }
            }
        }

        function startTimer() {
            var seconds = timerDuration;
            var milliseconds = 0;
            startTime = Date.now();

            timer = setInterval(function() {
                var currentTime = Date.now();
                elapsedTime = Math.floor((currentTime - startTime) / 1000);

                if (seconds <= 0 && milliseconds <= 0) {
                    clearInterval(timer);
                    showFailPopup();
                    $('.quiz__wrap .title').addClass("stop done");
                } else {
                    if (milliseconds <= 0) {
                        milliseconds = 99;
                        seconds--;
                    }
                    milliseconds--;

                    $('.timer span:first').text(seconds < 10 ? "0" + seconds : seconds);
                    $('.timer span:last').text(milliseconds < 10 ? "0" + milliseconds : milliseconds);
                }
            }, 10);
        }

        function stopTimer() {
            clearInterval(timer);
            var endTime = Date.now();
            elapsedTime = Math.floor((endTime - startTime) / 1000);
        }

        function checkAnswer(userAnswer) {
            if (currentQuestionIndex < selectedQuestions.length) {
                var correctAnswer = selectedQuestions[currentQuestionIndex].answer;
                if (userAnswer === correctAnswer) {
                    correctAnswers++;
                    score += 10;
                }
                currentQuestionIndex++;
            }

            if (currentQuestionIndex >= totalQuestions) {
                stopTimer();
                $('.quiz__wrap .title').addClass("stop");
                if (score >= 80) {
                    showSuccessPopup();
                } else {
                    showLosePopup();
                }
            } else {
                showQuestion(currentQuestionIndex);
            }
        }

        function showSuccessPopup() {
            $(".popup").removeClass("fail lose").addClass("success active");

            if (elapsedTime <= 30) {
                $(".msg.success1").show();
                $(".msg.success2, .msg.success3").hide();
            } else if (elapsedTime <= 60) {
                $(".msg.success2").show();
                $(".msg.success1, .msg.success3").hide();
            } else {
                $(".msg.success3").show();
                $(".msg.success1, .msg.success2").hide();
            }

            $(".record").text(elapsedTime);
            $(".score").text(score);
            $(".quiz").css("display", "none");
            animateBars();
        }

        function showLosePopup() {
            $(".popup").removeClass("success fail").addClass("lose active");
            $(".record").text(elapsedTime);
            $(".score").text(score);
            $(".quiz").css("display", "none");
            animateBars();
        }

        function showFailPopup() {
            $(".popup").removeClass("lose success").addClass("fail active");
            $(".quiz").css("display", "none");
            animateBars();
        }

        function animateBars() {
            var parentWidth = $(".graph__wrap").width(); // 부모 컨테이너의 실제 너비를 가져옵니다.
            var averageBarRatio = 0.5; // 117px 비율에 해당
            var maxBarRatio = 1; // 229px에 해당
            var qaBarRatio = 0.03; // qa 바는 3% 고정

            var playerRatio = Math.min(elapsedTime / 48, 1);
            var playerWidth = playerRatio * maxBarRatio * 100 + "%";
            var averageWidth = averageBarRatio * 100 + "%"; // 평균 바는 항상 50%
            var qaWidth = qaBarRatio * 100 + "%"; // QA 바는 항상 3%

            setTimeout(function() {
                $(".player .graph .bar").animate({ width: playerWidth }, 1000);
                $(".qa .graph .bar").animate({ width: qaWidth }, 1000);
                $(".average .graph .bar").animate({ width: averageWidth }, 1000);

                // PLAYER의 RESULT를 분/초 형식으로 표시
                var totalMilliseconds = Date.now() - startTime; // 밀리초 단위로 경과 시간 측정
                var minutes = Math.floor(totalMilliseconds / 60000); // 1분 = 60000 밀리초
                var seconds = Math.floor((totalMilliseconds % 60000) / 1000); // 나머지를 초로 변환

                // seconds가 한 자리일 경우 0을 붙여 두 자리로 표시
                var timeDisplay = minutes > 0 ? minutes + "분 " + (seconds < 10 ? "0" : "") + seconds + "초" : seconds + "초";
                $(".player .result .record").text(timeDisplay);
            }, 100);
        }

        $(".btn__o").click(function() {
            checkAnswer("O");
        });

        $(".btn__x").click(function() {
            checkAnswer("X");
        });

        selectRandomQuestions();
        showQuestion(currentQuestionIndex);
        startTimer();
    })
</script>
</body>
</html>