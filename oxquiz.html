<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="static/scss/common.css">
    <link rel="stylesheet" href="static/scss/quiz.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <title>OX 퀴즈</title>
</head>
<body>
    <header class="header">
        <h1>
            <a href="oxquiz_intro.html">
                <img src="static/images/quiz/logo.png" alt="ptkorea">
            </a>
        </h1>
        <p><strong>OX </strong>QUIZ</p>
    </header>
    <div class="container">
        <div class="contents">
            <div class="quiz__wrap">
                <div class="title">
                    <p><span class="text--orange">Y</span>OU</p>
                    <p>QA Tool</p>
                    <!-- <div class="system_done"></div> --> <!-- 241028 삭제 -->
                    <div class="timer__wrap">
                        <div class="wave_ani__wrap">
                            <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                            viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
                                <defs>
                                    <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
                                </defs>
                                <g class="wave__ani">
                                    <use xlink:href="#gentle-wave" x="48" y="0" fill="#feb95a" />
                                </g>
                            </svg>
                        </div>
                        <div class="timer"><span>45</span>:<span>00</span></div>
                        <div class="time_over__ani">
                            <img src="static/images/quiz/img_timeover.png" alt="timeover">
                        </div>
                    </div>
                    <div class="water_drop__ani">
                        <span class="water_drop1"></span>
                        <span class="water_drop2"></span>
                        <span class="water_drop3"></span>
                    </div>
                </div>
                <div class="quiz">
                    <p>Q. <span class="num"><em class="count">1</em>/10</span></p>
                    <p class="question">여기에 문제가 표시됩니다.</p>
                    <p class="tip__wrap">Tip <span class="tip">제품 여러개가 노출되면 복잡해 보이겠네요.</span></p>
                    <img src="static/images/quiz/img_question01.png" alt="q1" id="question-image">
                    <div class="btn__wrap">
                        <button type="button" class="btn btn__o">O</button>
                        <button type="button" class="btn btn__x">X</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- <div class="popup fail">
        <div class="popup__inner">
            <p class="result"><strong>아쉽습니다.</strong>시간이 너무 짧았죠. <br> 저희 QA Tool 만큼은 아니지만 <br>그래도 최선을 다해 퀴즈를 풀어주셔서<br>감사합니다.</p>
            <p class="msg">저희가 준비한 “참가상” 받아가세요!<br>ByeBye~</p>
            <a href="oxquiz_intro.html" class="btn__next">→ 다음 게임</a>
        </div>
    </div>

    <div class="popup success">
        <div class="popup__inner">
            <img src="static/images/quiz/img_success.png" alt="성공">
            <p class="result"><strong>기록! “<span class="record">21</span>초”</strong>저희 QA Tool은 0.03초만에 풀었는데…</p>
            <p class="score__wrap"><span class="score">90</span>점</p>
            <p class="msg">축하드립니다.<br>역시 콘텐츠를 보실 줄 아시는<br> <span class="text--blue">QA Master</span>를 만나게 되어 기쁩니다.</p>
            <a href="oxquiz_intro.html" class="btn__next">→ 간식받아 가세요</a>
        </div>
    </div>

    <div class="popup lose">
        <div class="popup__inner">
            <img src="static/images/quiz/img_lose.png" alt="실패">
            <p class="result"><strong>기록! “<span class="record">21</span>초”</strong>저희 QA Tool은 0.03초만에 풀었는데…</p>
            <p class="score__wrap"><span class="score">50</span>점</p>
            <p class="msg">안타깝습니다.<br>제한시간에 문제풀이를 마치셨지만, 아<br>쉽게도 기준 점수에는 부족하네요.</p>
            <a href="oxquiz_intro.html" class="btn__next">→ 간식받아 가세요</a>
        </div>
    </div> -->

    <div class="popup lose">
        <div class="popup__inner">
            <div class="popup__title__wrap">
                <p class="popup__title">아쉽습니다</p>
                <p class="score__wrap"><span class="score">50</span>점</p>
            </div>
            <img src="static/images/quiz/img_lose.png" alt="실패" class="img__fail">
            <img src="static/images/quiz/img_success.png" alt="성공" class="img__success">
            <div class="record__box">
                <ul>
                    <li class="player">
                        <strong class="record__title">플레이어 기록</strong>
                        <p class="fail">Time over</p>
                        <div class="graph__wrap">
                            <div class="graph">
                                <div class="bar"></div>
                                <p class="result"><span class="record">23</span>초</p>
                            </div>
                        </div>
                    </li>
                    <li class="average">
                        <strong class="record__title">평균 기록</strong>
                        <div class="graph__wrap">
                            <div class="graph">
                                <div class="bar"></div>
                                <p class="result">23초</p>
                            </div>
                        </div>
                    </li>
                    <li class="qa">
                        <strong class="record__title">QA Tool 기록</strong>
                        <div class="graph__wrap">
                            <div class="graph">
                                <div class="bar"></div>
                                <p class="result">0.03초</p>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
            <p class="msg fail">시간이 너무 짧았죠.<br>최선을 다해 퀴즈를 풀어주셔서 감사합니다.<br><strong>저희가 준비한 “참가상” 받아가세요!</strong></p>
            <p class="msg success">축하드립니다.<br>역시 콘텐츠를 보실 줄 아시는 <br><strong class="text--blue">QA Master</strong>를 만나게 되어 기쁩니다.</p>
            <p class="msg lose">안타깝습니다.<br>제한시간에 문제풀이를 마치셨지만,<br>아쉽게도 기준 점수에는 부족하네요.</p>
            <a href="oxquiz_intro.html" class="btn__next">→ 간식받아 가세요</a>
        </div>
    </div>
     
<script>
    $(document).ready(function(){
        /* s: 241028 스크립트 삭제 */
        // setTimeout(function(){
            //     $('.system_done').addClass('active');
            // }, 1000)
        /* e: 241028 스크립트 삭제 */
            
            // 퀴즈 데이터 배열 (문제, 이미지, 정답)
        var quizData = [
            { question: "올바른 제품 정보 전달을 위해 깨끗한 제품 이미지를 노출한다.", image: "static/images/quiz/img_question01.png", answer: "O", tip: "정확한 제품에 대한 이미지를 사용해야 해요."},
            { question: "좁은 공간 최대한 많은 제품을 표현하기 위해 모든 제품을 겹겹히 노출시킬수 있다.", image: "static/images/quiz/img_question02.png", answer: "X", tip: "겹겹히 노출된 제품은 명확히 어떤 제품인지 인지 하기 어려울수 있어요."},
            { question: "제품 이미지는 최대한 많은 제품을 노출해야 한다.", image: "static/images/quiz/img_question03.png", answer: "X", tip: "좁은 영역에서 너무 많은 제품 노출은 제품 정보 표현에 방해될 수 있어요."},
            { question: "PTK의 로고는 아래와 같이 사용된다", image: "static/images/quiz/img_question04.png", answer: "O", tip: "PTK의 정석 로고는 위와 같이 쓰여요."},
            { question: "PTK의 로고는 아래와 같이 사용된다", image: "static/images/quiz/img_question05.png", answer: "X", tip: "PTK 로고는 단일 컬러로 이루어져있어요."},
            { question: "PTK의 로고는 아래와 같이 사용된다", image: "static/images/quiz/img_question06.png", answer: "X", tip: "이것보다는 디자인이 들어간 형태일거에요."},
            { question: "2개 이상의 제품 구성으로 디자인할 경우 제품이 겹치지 않게 구성해야 한다.", image: "static/images/quiz/img_question07.png", answer: "O", tip: "주요 제품 대표 상품에 대한 정보로 인식이 편해요."},
            { question: "타이틀 영역에는 요즘 MZ 세대 의사를 반영한 표현으로 카피 설정이 가능하다.", image: "static/images/quiz/img_question08.png", answer: "X", tip: "모두가 이해할 수 있는 언어로 카피 구성이 되어야 해요."},
            { question: "제품의 배경 색상은 제품과 어울리는 컬러로 적용해도 된다.", image: "static/images/quiz/img_question09.png", answer: "O", tip: "제품을 잘 표현해 낼 수 있는 단일 컬러 구성으로 특정 컬러 제한없이 가이드 하고 있어요."},
            { question: "제품이미지들에 맞추어 상하 그라데이션도, 제품의 표현도 가능하다.", image: "static/images/quiz/img_question10.png", answer: "X", tip: "콘텐츠제작 가이드에서는 원형 그라데이션으로 배경 구성을 하고 있어요."},
            { question: "이미지 하단 카피는 이미지내 카피 내용이 포함된 경우 미적용해도 된다.", image: "static/images/quiz/img_question11.png", answer: "X", tip: "이미지내 카피 적용보다는 카피 영역을 사용하도록 가이드 하고 있어요."},
            { question: "제품의 효과적인 표현을 위해 반짝이는 요소들을 배치하여 데코해도 된다.", image: "static/images/quiz/img_question12.png", answer: "X", tip: "제품 이미지와 배경에 데코는 페이지 전체 혼란스러운 탐색 경험을 제공해요."},
            { question: "썸네일의 영역을 최대한 활용하여 이미지를 디자인한다.", image: "static/images/quiz/img_question13.png", answer: "X", tip: "어떤 제품인지 명확한게 인지 하기 어려운 이미지들은 정보탐색 경험에 방해되요."},
            { question: "전체적인 페이지의 심플한 구성 노출을 위해 정해진 영역안에서 이미지를 노출시킨다.", image: "static/images/quiz/img_question14.png", answer: "O", tip: "규격화된 가이드를 통해 깔끔하고 체계적으로 정리된 페이지로 구현되요."},
            { question: "제품의 노출은 디자인에 따라서 일부만 노출될 수 있다.", image: "static/images/quiz/img_question15.png", answer: "X", tip: "제품의 전체 정보를 소구할수 없어 사용자가 잘못된 정보를 경험할 수 있어요. "},
        ];

        var selectedQuestions = [];
        var totalQuestions = 10;
        var correctAnswers = 0;
        var score = 0;  
        var currentQuestionIndex = 0;
        var timerDuration = 30; 
        var timer;
        var startTime;
        var elapsedTime = 0;

        function selectRandomQuestions() {
            var quizPool = quizData.slice(); 
            while (selectedQuestions.length < totalQuestions) {
                var randomIndex = Math.floor(Math.random() * quizPool.length);
                selectedQuestions.push(quizPool.splice(randomIndex, 1)[0]);
            }
        }

        function showQuestion(index) {
            if (index < selectedQuestions.length) {
                var question = selectedQuestions[index];
                $(".question").text(question.question); 
                $("#question-image").attr("src", question.image);
                
                if (question.tip) {
                    $(".tip__wrap").show();
                    $(".tip").text(question.tip);
                } else {
                    $(".tip__wrap").hide();
                }

                $(".count").text(index + 1);
            } else {
                console.error("Index out of bounds");
            }
        }

        function startTimer() {
            var seconds = timerDuration;
            var milliseconds = 0;
            startTime = Date.now();

            timer = setInterval(function() {
                var currentTime = Date.now();
                elapsedTime = Math.floor((currentTime - startTime) / 1000);

                if (seconds <= 0 && milliseconds <= 0) {
                    clearInterval(timer);
                    showFailPopup();
                    $('.quiz__wrap .title').addClass("stop done");
                } else {
                    if (milliseconds <= 0) {
                        milliseconds = 99;
                        seconds--;
                    }
                    milliseconds--;

                    $('.timer span:first').text(seconds < 10 ? "0" + seconds : seconds);
                    $('.timer span:last').text(milliseconds < 10 ? "0" + milliseconds : milliseconds);
                }
            }, 10);
        }

        function stopTimer() {
            clearInterval(timer);
            var endTime = Date.now();
            elapsedTime = Math.floor((endTime - startTime) / 1000);
        }

        function checkAnswer(userAnswer) {
            if (currentQuestionIndex < selectedQuestions.length) {
                var correctAnswer = selectedQuestions[currentQuestionIndex].answer;
                if (userAnswer === correctAnswer) {
                    correctAnswers++;
                    score += 10; 
                }
                currentQuestionIndex++;
            }

            if (currentQuestionIndex >= totalQuestions) {
                stopTimer();
                $('.quiz__wrap .title').addClass("stop");
                if (score >= 80) {
                    showSuccessPopup();
                } else {
                    showLosePopup();
                }
            } else {
                showQuestion(currentQuestionIndex);
            }
        }

        // 성공 팝업 표시 함수
        function showSuccessPopup() {
            $(".popup").removeClass("fail lose").addClass("success active");
            $(".record").text(elapsedTime);  
            $(".score").text(score);
            $(".quiz").css("display", "none");
            animateBars();
        }

        // 실패 팝업 표시 함수
        function showLosePopup() {
            $(".popup").removeClass("fail success").addClass("lose active");
            $(".record").text(elapsedTime);
            $(".score").text(score);
            $(".quiz").css("display", "none");
            animateBars();
        }

        // 시간 초과 팝업 표시 함수
        function showFailPopup() {
            $(".popup").removeClass("lose success").addClass("fail active");
            $(".quiz").css("display", "none");
            animateBars();
        }

        function animateBars() {
            var maxBarWidth = 212; // 최대 너비는 212px
            var averageMaxWidth = 104; // 최대 너비는 104px
            var qaWidth = "7px"; // 7px 고정

            var playerWidth;
            if (elapsedTime < 23) {
                playerWidth = Math.min((elapsedTime / 23) * averageMaxWidth, averageMaxWidth) + "px";
            } else {
                playerWidth = Math.min((elapsedTime / 23) * maxBarWidth, maxBarWidth) + "px";
            }

            var averageWidth = averageMaxWidth + "px"; // average는 104px 고정

            // 초기 상태 설정
            $(".player .graph .bar, .average .graph .bar, .qa .graph .bar").css("width", "0");

            // setTimeout을 사용해 목표 너비로 변경하여 애니메이션 트리거
            setTimeout(function() {
                $(".player .graph .bar").css("width", playerWidth);
                $(".average .graph .bar").css("width", averageWidth);
                $(".qa .graph .bar").css("width", qaWidth);
            }, 100);
        }

        $(".btn__o").click(function() {
            checkAnswer("O");
        });

        $(".btn__x").click(function() {
            checkAnswer("X");
        });

        selectRandomQuestions();
        showQuestion(currentQuestionIndex);
        startTimer();
    })
</script>
</body>
</html>